# PHP-FPM
ProxyTimeout 900
<FilesMatch \.php$>
    SetHandler "proxy:unix:${SNAP_DATA}/php/php-fpm.sock|fcgi://localhost/"
</FilesMatch>

<Proxy "fcgi://localhost/">
</Proxy>

# Serve static assets for apps in a writable location.
Alias "/extra-apps" "${SNAP_DATA}/nextcloud/extra-apps"
<Directory "${SNAP_DATA}/nextcloud/extra-apps">
    AllowOverride None
    Require all granted
</Directory>

<Directory "${SNAP}/htdocs">
    # Include Nextcloud's .htaccess file directly. In a typical setup this would
    # be dangerous since it increases the capability of the .htaccess file in
    # case an attacker was able to modify it, but that's not actually possible
    # on Snappy (since the .htaccess file is read-only) so we'll do it here so
    # as to avoid manually copying it in and needing to maintain it.
    Include ${SNAP}/htdocs/.htaccess

    # Note that nothing else is included here as this directive is merged with
    # the one in the main configuration file.
</Directory>
